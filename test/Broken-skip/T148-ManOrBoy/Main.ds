-- Hmm, can't infer the type of this function. Why?
a :: Int -> a -> a -> a -> a -> a -> Int
a k x1 x2 x3 x4 x5
 = do	b () = do { k := k - 1 ; a k b x1 x2 x3 x4 }
	if k <= 0 then x4 () + x5 () else b ()

fn n = \() -> n

main ()	-- Function 'a' should return -67
 = do	out = a 10 (fn 1) (fn -1) (fn -1) (fn 1) (fn 0)
 	if out /= -67
	 then println $ "Output was " % show out % ". Should have been -67."
	 else println "Passed!"

