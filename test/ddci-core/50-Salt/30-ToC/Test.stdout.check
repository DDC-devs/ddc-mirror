
-- Convert a Core Salt module into raw C code.
ok
ok
Obj* addInt32 (Obj* x, Obj* y)
{
        int32_t _sym_xZPm = unboxInt32 (x);
        int32_t _sym_yZPm = unboxInt32 (y);
        int32_t r        = (_sym_xZPm + _sym_yZPm);
        Obj* z           = boxInt32 (r);
        return z;
}

Obj* boxInt32 (int32_t x)
{
        Obj* obj         = allocRaw (0, 4);
        addr_t addr      = _takePtr (Obj, obj);
        _write (int32_t, addr, 8, x);
        return obj;
}

int32_t unboxInt32 (Obj* obj)
{
        addr_t addr      = _takePtr (Obj, obj);
        int32_t x        = _read (int32_t, addr, 8);
        return x;
}

int32_t main (nat_t argc, string_t* argv)
{
        Obj* x           = boxInt32 (5);
        Obj* x2          = addInt32 (x, x);
        int32_t x0       = unboxInt32 (x2);
        string_t str     = _showInt32 (x0);
        _putStrLn (str);
        return 0;
}

