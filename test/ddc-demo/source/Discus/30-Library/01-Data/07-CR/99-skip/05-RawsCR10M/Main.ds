module Main
import System.IO.Console
import Class.Show
import Class.Numeric
import Class.Ord
import Data.Numeric.Nat
import Data.Function
import Data.Ref
import Data.CompactRegion

where

oneGb : Nat
  = 1073741824

oneMb : Nat
 = 1048576

fib (a: Nat) : Nat
 = case a of
    0 -> 1
    1 -> 1
    _ -> (fib (a-1)) + (fib (a-2))

allocTestRawToCR {@r : Region} (cr : CR r): S (Write r + Alloc r) (Vector# r Word8#)
 = do storeCR cr (allocTestRaw {@r} (oneMb * 10))
      
main ()
 =  mutable r1 r2 in
     do 
        cr = allocCR {@r2} ()
        obj = allocTestRawToCR cr

        writel $ "Start compute Fib Numbers.  "
        fib 40

        writel $" "
        writel $ "done! "


