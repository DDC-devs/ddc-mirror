ok
ok
ok

-- Simple Functions.
module Test with
letrec {
  foo: Ptr# rT Obj -> Ptr# rT Obj
    = λ(x: Ptr# rT Obj).
      let xx2    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 3# in
              ^1 in
      let xx3    
            = let ^      
                    = xx2 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) in
              ^0 in
      let xx4    
            = let ^      
                    = x in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) in
              ^0 in
      let xx5    
            = add# [Nat#] xx3 xx4 in
      let xx0    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) xx5 in
              ^1 in
      let xx6    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 2# in
              ^1 in
      let xx7    
            = let ^      
                    = xx6 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) in
              ^0 in
      let xx8    
            = let ^      
                    = xx0 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) in
              ^0 in
      let xx9    
            = add# [Nat#] xx7 xx8 in
      let ^      
            = ddcSmallAlloc [rT] TAG0# 1# in
      let ^      
            = ddcSmallPayload [rT] ^0 in
      let _      
            = poke# [rT] [Nat#]
                  (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) xx9 in
      ^1;
  
  _init$Test: Ptr# rT Obj -> Ptr# rT Obj
    = λ(xx1: Ptr# rT Obj). ddcBoxedAlloc [rT] TAG0# 0#
}


-- Match aginst literal Bools.
module Test with
letrec {
  neg: Ptr# rT Obj -> Ptr# rT Obj
    = λ(x: Ptr# rT Obj).
      let xx1    
            = let ^      
                    = x in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Bool#]
                          (plusPtr# [rT] [Bool#] (castPtr# [rT] [Bool#] [Word8#] ^0) 0#) in
              ^0 in
      case xx1 of {
        True#  
         -> let ^      
                  = ddcSmallAlloc [rT] TAG0# 1# in
            let ^      
                  = ddcSmallPayload [rT] ^0 in
            let _      
                  = poke# [rT] [Bool#]
                        (plusPtr# [rT] [Bool#] (castPtr# [rT] [Bool#] [Word8#] ^0) 0#) False# in
            ^1;
        _ 
         -> let ^      
                  = ddcSmallAlloc [rT] TAG0# 1# in
            let ^      
                  = ddcSmallPayload [rT] ^0 in
            let _      
                  = poke# [rT] [Bool#]
                        (plusPtr# [rT] [Bool#] (castPtr# [rT] [Bool#] [Word8#] ^0) 0#) True# in
            ^1
      };
  
  _init$Test: Ptr# rT Obj -> Ptr# rT Obj
    = λ(xx0: Ptr# rT Obj). ddcBoxedAlloc [rT] TAG0# 0#
}


-- Match against literal Nat.
module Test with
letrec {
  foo: Ptr# rT Obj -> Ptr# rT Obj
    = λ(x: Ptr# rT Obj).
      let xx1    
            = let ^      
                    = x in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) in
              ^0 in
      case xx1 of {
        5#  
         -> let ^      
                  = ddcSmallAlloc [rT] TAG0# 1# in
            let ^      
                  = ddcSmallPayload [rT] ^0 in
            let _      
                  = poke# [rT] [Nat#]
                        (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 6# in
            ^1;
        6#  
         -> let ^      
                  = ddcSmallAlloc [rT] TAG0# 1# in
            let ^      
                  = ddcSmallPayload [rT] ^0 in
            let _      
                  = poke# [rT] [Nat#]
                        (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 7# in
            ^1;
        _ 
         -> let ^      
                  = ddcSmallAlloc [rT] TAG0# 1# in
            let ^      
                  = ddcSmallPayload [rT] ^0 in
            let _      
                  = poke# [rT] [Nat#]
                        (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 0# in
            ^1
      };
  
  _init$Test: Ptr# rT Obj -> Ptr# rT Obj
    = λ(xx0: Ptr# rT Obj). ddcBoxedAlloc [rT] TAG0# 0#
}


-- Nested case expression.
module Test with
letrec {
  foo: Ptr# rT Obj -> Ptr# rT Obj -> Ptr# rT Obj
    = λ(x y: Ptr# rT Obj).
      let xx1    
            = let ^      
                    = x in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) in
              ^0 in
      case xx1 of {
        0#  
         -> let xx2    
                  = let ^      
                          = y in
                    let ^      
                          = ddcSmallPayload [rT] ^0 in
                    let ^      
                          = peek# [rT] [Nat#]
                                (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) in
                    ^0 in
            case xx2 of {
              0#  
               -> let ^      
                        = ddcSmallAlloc [rT] TAG0# 1# in
                  let ^      
                        = ddcSmallPayload [rT] ^0 in
                  let _      
                        = poke# [rT] [Nat#]
                              (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 1# in
                  ^1;
              _ 
               -> let ^      
                        = ddcSmallAlloc [rT] TAG0# 1# in
                  let ^      
                        = ddcSmallPayload [rT] ^0 in
                  let _      
                        = poke# [rT] [Nat#]
                              (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 0# in
                  ^1
            };
        _ 
         -> let ^      
                  = ddcSmallAlloc [rT] TAG0# 1# in
            let ^      
                  = ddcSmallPayload [rT] ^0 in
            let _      
                  = poke# [rT] [Nat#]
                        (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 0# in
            ^1
      };
  
  _init$Test: Ptr# rT Obj -> Ptr# rT Obj
    = λ(xx0: Ptr# rT Obj). ddcBoxedAlloc [rT] TAG0# 0#
}


-- Full application of top-level function.
module Test with
letrec {
  add: Ptr# rT Obj -> Ptr# rT Obj -> Ptr# rT Obj
    = λ(x y: Ptr# rT Obj).
      let xx1    
            = let ^      
                    = x in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) in
              ^0 in
      let xx2    
            = let ^      
                    = y in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) in
              ^0 in
      let xx3    
            = add# [Nat#] xx1 xx2 in
      let ^      
            = ddcSmallAlloc [rT] TAG0# 1# in
      let ^      
            = ddcSmallPayload [rT] ^0 in
      let _      
            = poke# [rT] [Nat#]
                  (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) xx3 in
      ^1;
  
  foo: Ptr# rT Obj -> Ptr# rT Obj
    = λ(x: Ptr# rT Obj).
      let xx4    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 5# in
              ^1 in
      add x xx4;
  
  _init$Test: Ptr# rT Obj -> Ptr# rT Obj
    = λ(xx0: Ptr# rT Obj). ddcBoxedAlloc [rT] TAG0# 0#
}


-- Flip an enumerated value.
module Test with
letrec {
  flipit: Ptr# rT Obj -> Ptr# rT Obj
    = λ(x: Ptr# rT Obj).
      case ddcBoxedTag [rT] x of {
        TAG0#  
         -> let ^      
                  = ddcBoxedAlloc [rT] TAG1# 0# in
            ^0;
        TAG1#  
         -> let ^      
                  = ddcBoxedAlloc [rT] TAG0# 0# in
            ^0;
        _ 
         -> fail# [Ptr# rT Obj]
      };
  
  _init$Test: Ptr# rT Obj -> Ptr# rT Obj
    = λ(xx0: Ptr# rT Obj).
      let xx5    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 2# in
              ^1 in
      let xx6    
            = let ^      
                    = xx5 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) in
              ^0 in
      let xx7    
            = ddcInfoFrameNew xx6 in
      let xx1    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) xx7 in
              ^1 in
      let xx8    
            = let ^      
                    = xx1 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) in
              ^0 in
      let xx9    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 0w16# in
              ^1 in
      let xx10   
            = let ^      
                    = xx9 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx11   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 0w16# in
              ^1 in
      let xx12   
            = let ^      
                    = xx11 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx13   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Test"# in
              ^1 in
      let xx14   
            = let ^      
                    = xx13 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx15   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Hot"# in
              ^1 in
      let xx16   
            = let ^      
                    = xx15 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx17   
            = ddcInfoFrameAddData xx8 xx10 xx12 xx14 xx16 in
      let xx2    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word32#]
                          (plusPtr# [rT] [Word32#] (castPtr# [rT] [Word32#] [Word8#] ^0) 0#) xx17 in
              ^1 in
      let xx18   
            = let ^      
                    = xx1 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) in
              ^0 in
      let xx19   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 1w16# in
              ^1 in
      let xx20   
            = let ^      
                    = xx19 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx21   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 0w16# in
              ^1 in
      let xx22   
            = let ^      
                    = xx21 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx23   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Test"# in
              ^1 in
      let xx24   
            = let ^      
                    = xx23 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx25   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Cold"# in
              ^1 in
      let xx26   
            = let ^      
                    = xx25 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx27   
            = ddcInfoFrameAddData xx18 xx20 xx22 xx24 xx26 in
      let xx3    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word32#]
                          (plusPtr# [rT] [Word32#] (castPtr# [rT] [Word32#] [Word8#] ^0) 0#) xx27 in
              ^1 in
      let xx28   
            = let ^      
                    = xx1 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) in
              ^0 in
      let xx4    
            = ddcInfoFramePush xx28 in
      ddcBoxedAlloc [rT] TAG0# 0#
}


-- Function to take the head of a monomorphic list.
module Test with
letrec {
  head: Ptr# rT Obj -> Ptr# rT Obj
    = λ(xx: Ptr# rT Obj).
      case ddcBoxedTag [rT] xx of {
        TAG0#  
         -> let x      
                  = ddcBoxedGetField [rT] [rT] xx 0# in
            let x$Sx100
                  = ddcBoxedGetField [rT] [rT] xx 1# in
            x;
        _ 
         -> let ^      
                  = ddcSmallAlloc [rT] TAG0# 1# in
            let ^      
                  = ddcSmallPayload [rT] ^0 in
            let _      
                  = poke# [rT] [Nat#]
                        (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 0# in
            ^1
      };
  
  _init$Test: Ptr# rT Obj -> Ptr# rT Obj
    = λ(xx0: Ptr# rT Obj).
      let xx5    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 2# in
              ^1 in
      let xx6    
            = let ^      
                    = xx5 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) in
              ^0 in
      let xx7    
            = ddcInfoFrameNew xx6 in
      let xx1    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) xx7 in
              ^1 in
      let xx8    
            = let ^      
                    = xx1 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) in
              ^0 in
      let xx9    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 0w16# in
              ^1 in
      let xx10   
            = let ^      
                    = xx9 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx11   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 2w16# in
              ^1 in
      let xx12   
            = let ^      
                    = xx11 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx13   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Test"# in
              ^1 in
      let xx14   
            = let ^      
                    = xx13 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx15   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Cons"# in
              ^1 in
      let xx16   
            = let ^      
                    = xx15 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx17   
            = ddcInfoFrameAddData xx8 xx10 xx12 xx14 xx16 in
      let xx2    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word32#]
                          (plusPtr# [rT] [Word32#] (castPtr# [rT] [Word32#] [Word8#] ^0) 0#) xx17 in
              ^1 in
      let xx18   
            = let ^      
                    = xx1 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) in
              ^0 in
      let xx19   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 1w16# in
              ^1 in
      let xx20   
            = let ^      
                    = xx19 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx21   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 0w16# in
              ^1 in
      let xx22   
            = let ^      
                    = xx21 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx23   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Test"# in
              ^1 in
      let xx24   
            = let ^      
                    = xx23 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx25   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Nil"# in
              ^1 in
      let xx26   
            = let ^      
                    = xx25 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx27   
            = ddcInfoFrameAddData xx18 xx20 xx22 xx24 xx26 in
      let xx3    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word32#]
                          (plusPtr# [rT] [Word32#] (castPtr# [rT] [Word32#] [Word8#] ^0) 0#) xx27 in
              ^1 in
      let xx28   
            = let ^      
                    = xx1 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) in
              ^0 in
      let xx4    
            = ddcInfoFramePush xx28 in
      ddcBoxedAlloc [rT] TAG0# 0#
}


-- Function to take the head of a polymorphic list.
module Test with
letrec {
  head: [a$r: Region].Ptr# rT Obj -> Ptr# rT Obj -> Ptr# rT Obj
    = Λ(a$r: Region).
      λ(def xx: Ptr# rT Obj).
      case ddcBoxedTag [rT] xx of {
        TAG0#  
         -> let x      
                  = ddcBoxedGetField [rT] [rT] xx 0# in
            let x$Sx100
                  = ddcBoxedGetField [rT] [rT] xx 1# in
            x;
        _ 
         -> def
      };
  
  _init$Test: Ptr# rT Obj -> Ptr# rT Obj
    = λ(xx0: Ptr# rT Obj).
      let xx5    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 2# in
              ^1 in
      let xx6    
            = let ^      
                    = xx5 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) in
              ^0 in
      let xx7    
            = ddcInfoFrameNew xx6 in
      let xx1    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) xx7 in
              ^1 in
      let xx8    
            = let ^      
                    = xx1 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) in
              ^0 in
      let xx9    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 0w16# in
              ^1 in
      let xx10   
            = let ^      
                    = xx9 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx11   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 2w16# in
              ^1 in
      let xx12   
            = let ^      
                    = xx11 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx13   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Test"# in
              ^1 in
      let xx14   
            = let ^      
                    = xx13 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx15   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Cons"# in
              ^1 in
      let xx16   
            = let ^      
                    = xx15 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx17   
            = ddcInfoFrameAddData xx8 xx10 xx12 xx14 xx16 in
      let xx2    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word32#]
                          (plusPtr# [rT] [Word32#] (castPtr# [rT] [Word32#] [Word8#] ^0) 0#) xx17 in
              ^1 in
      let xx18   
            = let ^      
                    = xx1 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) in
              ^0 in
      let xx19   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 1w16# in
              ^1 in
      let xx20   
            = let ^      
                    = xx19 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx21   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 0w16# in
              ^1 in
      let xx22   
            = let ^      
                    = xx21 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx23   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Test"# in
              ^1 in
      let xx24   
            = let ^      
                    = xx23 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx25   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Nil"# in
              ^1 in
      let xx26   
            = let ^      
                    = xx25 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx27   
            = ddcInfoFrameAddData xx18 xx20 xx22 xx24 xx26 in
      let xx3    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word32#]
                          (plusPtr# [rT] [Word32#] (castPtr# [rT] [Word32#] [Word8#] ^0) 0#) xx27 in
              ^1 in
      let xx28   
            = let ^      
                    = xx1 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) in
              ^0 in
      let xx4    
            = ddcInfoFramePush xx28 in
      ddcBoxedAlloc [rT] TAG0# 0#
}


-- Case expressions on literals.
-- Need to unbox scrutinee.
module Test with
letrec {
  swap: Ptr# rT Obj -> Ptr# rT Obj
    = λ(x: Ptr# rT Obj).
      let xx1    
            = let ^      
                    = x in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) in
              ^0 in
      case xx1 of {
        0#  
         -> let ^      
                  = ddcSmallAlloc [rT] TAG0# 1# in
            let ^      
                  = ddcSmallPayload [rT] ^0 in
            let _      
                  = poke# [rT] [Nat#]
                        (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 1# in
            ^1;
        _ 
         -> let ^      
                  = ddcSmallAlloc [rT] TAG0# 1# in
            let ^      
                  = ddcSmallPayload [rT] ^0 in
            let _      
                  = poke# [rT] [Nat#]
                        (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 0# in
            ^1
      };
  
  _init$Test: Ptr# rT Obj -> Ptr# rT Obj
    = λ(xx0: Ptr# rT Obj). ddcBoxedAlloc [rT] TAG0# 0#
}


-- Polymorphically take the head of a list, where the element
-- is in the top-level region. In the Salt code the head function
-- is passed the top level region as the location of the element.
module Test with
letrec {
  head: [a$r: Region].Ptr# rT Obj -> Ptr# rT Obj -> Ptr# rT Obj
    = Λ(a$r: Region).
      λ(def xx: Ptr# rT Obj).
      case ddcBoxedTag [rT] xx of {
        TAG0#  
         -> let x      
                  = ddcBoxedGetField [rT] [rT] xx 0# in
            let x$Sx100
                  = ddcBoxedGetField [rT] [rT] xx 1# in
            x;
        _ 
         -> def
      };
  
  foo: Ptr# rT Obj -> Ptr# rT Obj
    = λ(x$Sx101: Ptr# rT Obj).
      let xx0    
            = let ^      
                    = ddcBoxedAlloc [rT] TAG1# 0# in
              ^0 in
      let xx7    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 1# in
              ^1 in
      let xx1    
            = let ^      
                    = ddcBoxedAlloc [rT] TAG0# 2# in
              let _      
                    = ddcBoxedSetField [rT] [rT] ^0 0# xx7 in
              let _      
                    = ddcBoxedSetField [rT] [rT] ^0 1# xx0 in
              ^0 in
      let xx8    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 0# in
              ^1 in
      head [rT] xx8 xx1;
  
  _init$Test: Ptr# rT Obj -> Ptr# rT Obj
    = λ(xx2: Ptr# rT Obj).
      let xx9    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 2# in
              ^1 in
      let xx10   
            = let ^      
                    = xx9 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) in
              ^0 in
      let xx11   
            = ddcInfoFrameNew xx10 in
      let xx3    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) xx11 in
              ^1 in
      let xx12   
            = let ^      
                    = xx3 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) in
              ^0 in
      let xx13   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 0w16# in
              ^1 in
      let xx14   
            = let ^      
                    = xx13 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx15   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 2w16# in
              ^1 in
      let xx16   
            = let ^      
                    = xx15 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx17   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Test"# in
              ^1 in
      let xx18   
            = let ^      
                    = xx17 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx19   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Cons"# in
              ^1 in
      let xx20   
            = let ^      
                    = xx19 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx21   
            = ddcInfoFrameAddData xx12 xx14 xx16 xx18 xx20 in
      let xx4    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word32#]
                          (plusPtr# [rT] [Word32#] (castPtr# [rT] [Word32#] [Word8#] ^0) 0#) xx21 in
              ^1 in
      let xx22   
            = let ^      
                    = xx3 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) in
              ^0 in
      let xx23   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 1w16# in
              ^1 in
      let xx24   
            = let ^      
                    = xx23 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx25   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 0w16# in
              ^1 in
      let xx26   
            = let ^      
                    = xx25 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx27   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Test"# in
              ^1 in
      let xx28   
            = let ^      
                    = xx27 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx29   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Nil"# in
              ^1 in
      let xx30   
            = let ^      
                    = xx29 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx31   
            = ddcInfoFrameAddData xx22 xx24 xx26 xx28 xx30 in
      let xx5    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word32#]
                          (plusPtr# [rT] [Word32#] (castPtr# [rT] [Word32#] [Word8#] ^0) 0#) xx31 in
              ^1 in
      let xx32   
            = let ^      
                    = xx3 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) in
              ^0 in
      let xx6    
            = ddcInfoFramePush xx32 in
      ddcBoxedAlloc [rT] TAG0# 0#
}


-- Polymorphically take the head of a list, where the element
-- has its own primary region annotation. In the Salt code the head
-- function is passed the top level region as the location of the element.
module Test with
letrec {
  head: [a$r: Region].Ptr# rT Obj -> Ptr# rT Obj -> Ptr# rT Obj
    = Λ(a$r: Region).
      λ(def xx: Ptr# rT Obj).
      case ddcBoxedTag [rT] xx of {
        TAG0#  
         -> let x      
                  = ddcBoxedGetField [rT] [rT] xx 0# in
            let x$Sx100
                  = ddcBoxedGetField [rT] [rT] xx 1# in
            x;
        _ 
         -> def
      };
  
  foo: [r: Region].Ptr# rT Obj -> Ptr# rT Obj
    = Λ(r: Region).
      λ(x$Sx101: Ptr# rT Obj).
      let xx0    
            = let ^      
                    = ddcBoxedAlloc [rT] TAG0# 0# in
              ^0 in
      let xx1    
            = let ^      
                    = ddcBoxedAlloc [rT] TAG1# 0# in
              ^0 in
      let xx2    
            = let ^      
                    = ddcBoxedAlloc [rT] TAG1# 0# in
              ^0 in
      let xx3    
            = let ^      
                    = ddcBoxedAlloc [rT] TAG0# 2# in
              let _      
                    = ddcBoxedSetField [rT] [rT] ^0 0# xx1 in
              let _      
                    = ddcBoxedSetField [rT] [rT] ^0 1# xx2 in
              ^0 in
      head [rT] xx0 xx3;
  
  _init$Test: Ptr# rT Obj -> Ptr# rT Obj
    = λ(xx4: Ptr# rT Obj).
      let xx13   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 2# in
              ^1 in
      let xx14   
            = let ^      
                    = xx13 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) in
              ^0 in
      let xx15   
            = ddcInfoFrameNew xx14 in
      let xx5    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) xx15 in
              ^1 in
      let xx16   
            = let ^      
                    = xx5 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) in
              ^0 in
      let xx17   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 0w16# in
              ^1 in
      let xx18   
            = let ^      
                    = xx17 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx19   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 2w16# in
              ^1 in
      let xx20   
            = let ^      
                    = xx19 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx21   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Test"# in
              ^1 in
      let xx22   
            = let ^      
                    = xx21 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx23   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Cons"# in
              ^1 in
      let xx24   
            = let ^      
                    = xx23 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx25   
            = ddcInfoFrameAddData xx16 xx18 xx20 xx22 xx24 in
      let xx6    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word32#]
                          (plusPtr# [rT] [Word32#] (castPtr# [rT] [Word32#] [Word8#] ^0) 0#) xx25 in
              ^1 in
      let xx26   
            = let ^      
                    = xx5 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) in
              ^0 in
      let xx27   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 1w16# in
              ^1 in
      let xx28   
            = let ^      
                    = xx27 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx29   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 0w16# in
              ^1 in
      let xx30   
            = let ^      
                    = xx29 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx31   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Test"# in
              ^1 in
      let xx32   
            = let ^      
                    = xx31 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx33   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Nil"# in
              ^1 in
      let xx34   
            = let ^      
                    = xx33 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx35   
            = ddcInfoFrameAddData xx26 xx28 xx30 xx32 xx34 in
      let xx7    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word32#]
                          (plusPtr# [rT] [Word32#] (castPtr# [rT] [Word32#] [Word8#] ^0) 0#) xx35 in
              ^1 in
      let xx36   
            = let ^      
                    = xx5 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) in
              ^0 in
      let xx8    
            = ddcInfoFramePush xx36 in
      let xx37   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) 2# in
              ^1 in
      let xx38   
            = let ^      
                    = xx37 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Nat#]
                          (plusPtr# [rT] [Nat#] (castPtr# [rT] [Nat#] [Word8#] ^0) 0#) in
              ^0 in
      let xx39   
            = ddcInfoFrameNew xx38 in
      let xx9    
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) xx39 in
              ^1 in
      let xx40   
            = let ^      
                    = xx9 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) in
              ^0 in
      let xx41   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 0w16# in
              ^1 in
      let xx42   
            = let ^      
                    = xx41 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx43   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 0w16# in
              ^1 in
      let xx44   
            = let ^      
                    = xx43 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx45   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Test"# in
              ^1 in
      let xx46   
            = let ^      
                    = xx45 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx47   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Hot"# in
              ^1 in
      let xx48   
            = let ^      
                    = xx47 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx49   
            = ddcInfoFrameAddData xx40 xx42 xx44 xx46 xx48 in
      let xx10   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word32#]
                          (plusPtr# [rT] [Word32#] (castPtr# [rT] [Word32#] [Word8#] ^0) 0#) xx49 in
              ^1 in
      let xx50   
            = let ^      
                    = xx9 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) in
              ^0 in
      let xx51   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 1w16# in
              ^1 in
      let xx52   
            = let ^      
                    = xx51 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx53   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) 0w16# in
              ^1 in
      let xx54   
            = let ^      
                    = xx53 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Word16#]
                          (plusPtr# [rT] [Word16#] (castPtr# [rT] [Word16#] [Word8#] ^0) 0#) in
              ^0 in
      let xx55   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Test"# in
              ^1 in
      let xx56   
            = let ^      
                    = xx55 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx57   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) "Cold"# in
              ^1 in
      let xx58   
            = let ^      
                    = xx57 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [TextLit#]
                          (plusPtr# [rT] [TextLit#] (castPtr# [rT] [TextLit#] [Word8#] ^0) 0#) in
              ^0 in
      let xx59   
            = ddcInfoFrameAddData xx50 xx52 xx54 xx56 xx58 in
      let xx11   
            = let ^      
                    = ddcSmallAlloc [rT] TAG0# 1# in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let _      
                    = poke# [rT] [Word32#]
                          (plusPtr# [rT] [Word32#] (castPtr# [rT] [Word32#] [Word8#] ^0) 0#) xx59 in
              ^1 in
      let xx60   
            = let ^      
                    = xx9 in
              let ^      
                    = ddcSmallPayload [rT] ^0 in
              let ^      
                    = peek# [rT] [Addr#]
                          (plusPtr# [rT] [Addr#] (castPtr# [rT] [Addr#] [Word8#] ^0) 0#) in
              ^0 in
      let xx12   
            = ddcInfoFramePush xx60 in
      ddcBoxedAlloc [rT] TAG0# 0#
}

