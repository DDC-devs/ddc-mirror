:set lang Tetra


-- Flip it.
:load..
module Test 
data Hotness where
        Hot  : Hotness
        Cold : Hotness

with letrec 
flip (x : Hotness) : Hotness 
 = case x of
        Hot     -> Cold
        Cold    -> Hot
;;


-- List data type.
:load..
module Test 
data List (a : Data) where 
        Nil  : List a
        Cons : a -> List a -> List a

with
letrec {
  add : [a : Data].a -> a -> a
    = /\(a : Data).
       \(x y : a). add# [a] x y;
  
  length : [a : Data].List a -> Nat#
    = /\(a : Data).
       \(xx : List a).
      case xx of {
        Nil  
         -> 0#;
        Cons x xs
         -> add [Nat#] 1# (length [a] xs)
      }
}
;;


-- Data type containing a polymorphic function.
--   This makes the constructor type rank-2
:set Synth
:load..
module Test
data Box where
        Box : ([a : Data]. a -> a) -> Box

with letrec

thing (b : Box)
 = case b of
        Box f   -> f 5#
;;


-- Error: constructor does not produce the data type.
:set Synth..
:load.. 
module Test
data TheThing where
        C : Nat# -> NotTheThing
with letrec
eatThing (x : TheThing)
 = case x of
        C y     -> y
;;
