:set SuppressLetTypes

-- Fold and reduce at the same time.
:flow-lower..
module Test with letrec
ffold   [k : Rate] 
        (x : Ref# Int#)
        (s : Series# k Int#) : Int#
 = do
        sreduce# [k] [Int#] x (mul# [Int#]) 1i# s

        sfold# [k] [Int#] [Int#] (add# [Int#]) 0i# s
;;
