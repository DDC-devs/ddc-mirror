


-- Filter
:flow-lower..
module Test with letrec
filter  [k1 : Rate] [a : Data]
        (f  : a -> Bool#) (s : Series# k1 a)
        : Vector# a
 = do   
        flags   = map1# [k1] [a] [Bool#] (\(x : a). f x) s

        mkSel1# [k1] [Vector# a] flags
         (/\(k2 : Rate). \(sel : Sel1# k1 k2).
           let  s2      =  pack# [k1] [k2] [a] sel s
           in   vectorOfSeries#  [k2] [a] s2)
;;
