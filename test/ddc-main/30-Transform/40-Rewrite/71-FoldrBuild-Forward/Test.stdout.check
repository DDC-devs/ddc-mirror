ok
ok

ok
ok

ok, added foldrBuild

ok

-- define outside, otherwise beta reduction won't fire...
* TRANSFORM INFORMATION: 
    Inline: No information;
    fix 10:
        Beta reduction:
            Types:          0
            Witnesses:      0
            Values:         3
            Values letted:  1
            Values skipped: 0;
        Forward:
            Total bindings inspected:      1
              Trivial substitutions made:  0
              Bindings moved forward:      0;
        Rules fired:
            Unfold:  foldrBuild
            Rewrite: foldrBuild;
        Beta reduction:
            Types:          0
            Witnesses:      0
            Values:         0
            Values letted:  0
            Values skipped: 0;
        Forward:
            Total bindings inspected:      1
              Trivial substitutions made:  0
              Bindings moved forward:      0;
        Rules fired:
            

let num : Int R0# = 10 [R0#] () in
let ^ : [^ : Data].[^ ^ ^ : Effect].[^ ^ ^ : Closure].(Int R0# -(^5 | ^2)> ^6 -(^4 | ^1)> ^6) -(Pure | Use R0#)> (Unit -(^3 | ^0)> ^6) -(Read R0# + Alloc R0# + ^3 + ^4 + ^5 | Use R0# + ^2)> ^6
      = weakclo {num} in
        /\(^ : Data)./\(^ ^ ^ : Effect)./\(^ ^ ^ : Closure).
         \(^ : Int R0# -(^5 | ^2)> ^6 -(^4 | ^1)> ^6).\(^ : Unit -(^3 | ^0)> ^6).
        case num of {
          0  
           -> ^0 ();
          _ 
           -> ^1 num
                  (count'
                       (weakclo {num} in
                        subInt [R0#] [R0#] [R0#] num (1 [R0#] ())) [^6] [^5] [^4] [^3] [^2] [^1] [^0] ^1 ^0)
        } in
let ^ : List R1# (Int R0#)
      = build [Int R0#] [R1#] [Pure] [Read R0# + Alloc R0#] [Use R0#] [Use R0#] ^0 in
weakeff [Read R0# + Read R1# + Alloc R0# + Alloc R1#] in
weakclo {build; foldr; [Int]; [R0#]; [R1#]} in
^1 [Int R0#] [Pure] [Read R0# + Alloc R0#] [Alloc R0#] [Use R0#] [Use R0#] [Use R0#]
    (\(^ ^ : Int R0#). addInt [R0#] [R0#] [R0#] ^1 ^0)
    (\(^ : Unit). 0 [R0#] ())

ok

-- define outside, otherwise beta reduction won't fire...
* TRANSFORM INFORMATION: 
    fix 30:
        Forward:
            Total bindings inspected:      5
              Trivial substitutions made:  4
              Bindings moved forward:      4;
        Beta reduction:
            Types:          0
            Witnesses:      0
            Values:         3
            Values letted:  3
            Values skipped: 0;
        Bubble: No information;
        Prune:
            Removed:        0;
        Rules fired:
            Unfold:  foldrBuild;
        Snip: No information;
        Flatten: No information;
        Namify: No information;
        Forward:
            Total bindings inspected:      10
              Trivial substitutions made:  0
              Bindings moved forward:      0;
        Beta reduction:
            Types:          0
            Witnesses:      0
            Values:         0
            Values letted:  0
            Values skipped: 0;
        Bubble: No information;
        Prune:
            Removed:        0;
        Rules fired:
            Unfold:  foldrBuild
            Unfold:  foldrBuild
            Unfold:  foldrBuild
            Rewrite: foldrBuild;
        Snip: No information;
        Flatten: No information;
        Namify: No information;
        Forward:
            Total bindings inspected:      13
              Trivial substitutions made:  0
              Bindings moved forward:      3;
        Beta reduction:
            Types:          0
            Witnesses:      0
            Values:         0
            Values letted:  0
            Values skipped: 0;
        Bubble: No information;
        Prune:
            Removed:        1;
        Rules fired:
            Unfold:  foldrBuild
            Unfold:  foldrBuild;
        Snip: No information;
        Flatten: No information;
        Namify: No information;
        Forward:
            Total bindings inspected:      11
              Trivial substitutions made:  2
              Bindings moved forward:      3;
        Beta reduction:
            Types:          7
            Witnesses:      0
            Values:         2
            Values letted:  0
            Values skipped: 0;
        Bubble: No information;
        Prune:
            Removed:        0;
        Rules fired:
            Unfold:  foldrBuild
            Unfold:  foldrBuild
            Rewrite: foldrBuild;
        Snip: No information;
        Flatten: No information;
        Namify: No information;
        Forward:
            Total bindings inspected:      10
              Trivial substitutions made:  0
              Bindings moved forward:      2;
        Beta reduction:
            Types:          0
            Witnesses:      0
            Values:         0
            Values letted:  0
            Values skipped: 0;
        Bubble: No information;
        Prune:
            Removed:        1;
        Rules fired:
            Unfold:  foldrBuild;
        Snip: No information;
        Flatten: No information;
        Namify: No information;
        Forward:
            Total bindings inspected:      8
              Trivial substitutions made:  3
              Bindings moved forward:      2;
        Beta reduction:
            Types:          7
            Witnesses:      0
            Values:         2
            Values letted:  0
            Values skipped: 0;
        Bubble: No information;
        Prune:
            Removed:        0;
        Rules fired:
            Unfold:  foldrBuild
            Rewrite: foldrBuild;
        Snip: No information;
        Flatten: No information;
        Namify: No information;
        Forward:
            Total bindings inspected:      7
              Trivial substitutions made:  0
              Bindings moved forward:      1;
        Beta reduction:
            Types:          0
            Witnesses:      0
            Values:         0
            Values letted:  0
            Values skipped: 0;
        Bubble: No information;
        Prune:
            Removed:        1;
        Rules fired:
            ;
        Snip: No information;
        Flatten: No information;
        Namify: No information;
        Forward:
            Total bindings inspected:      5
              Trivial substitutions made:  0
              Bindings moved forward:      0;
        Beta reduction:
            Types:          0
            Witnesses:      0
            Values:         0
            Values letted:  0
            Values skipped: 0;
        Bubble: No information;
        Prune:
            Removed:        0;
        Rules fired:
            ;
        Snip: No information;
        Flatten: No information;
        Namify: No information

weakeff [Read R0# + Read R1# + Alloc R0# + Alloc R1#] in
let num : Int R0# = 10 [R0#] () in
let v7 : [t0 : Data].[t1 t2 t3 : Effect].[t4 t5 t6 : Closure].(Int R0# -(t1 | t4)> t0 -(t2 | t5)> t0) -(Pure | Use R0#)> (Unit -(t3 | t6)> t0) -(Read R0# + Alloc R0# + t1 + t2 + t3 | Use R0# + t4)> t0 = count' num in
weakclo {double; even; v7} in
let v33 : Int R0# -(Pure | Use R0#)> Int R0# -(Read R0# + Alloc R0# | Use R0#)> Int R0#
      = \(v30 v31 : Int R0#).
        let v32 : Int R0# = even v30 in
        case v32 of {
          0  
           -> plus v30 v31;
          _ 
           -> v31
        } in
let v18 : Int R0# -(Read R0# + Alloc R0# | Use R0#)> Int R0# -(Read R0# + Alloc R0# | Use R0#)> Int R0#
      = compose [Int R0#] [Int R0#] [Int R0# -(Read R0# + Alloc R0# | Use R0#)> Int R0#] [Pure] [Read R0# + Alloc R0#] [Use R0#] [Use R0#] v33 double in
v7 [Int R0#] [Read R0# + Alloc R0#] [Read R0# + Alloc R0#] [Alloc R0#] [Use R0#] [Use R0#] [Use R0#] v18 zero
