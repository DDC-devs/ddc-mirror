:set Indent
:set TraceTrans
-- import a function with polymorphic effects
:with test/ddc-main/30-Transform/40-Rewrite/T279-SumMatch/Module.dcs

-- silly rule with effect matching
:set.. rule silly [ef : !]
    (u : Unit).
        effectful [Read R0# + Write R0# + ef] u
        = u
;;

:set trans Rewrite

-- match 'ef' with an Alloc
:trans..
effectful [Read R0# + Write R0# + Alloc R0#]
    ()
;;

-- same length but doesn't include the Write
:trans..
effectful [Read R0# + Read R1# + Read R2#]
    ()
;;

-- longer - could match but doesn't
:trans..
effectful [Read R0# + Write R0# + Read R1# + Write R1#]
    ()
;;


