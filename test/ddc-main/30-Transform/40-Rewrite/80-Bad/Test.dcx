:set Indent
:with test/ddc-main/30-Transform/40-Rewrite/80-Bad/Module.dcs

-- Bad: rhs & lhs have different types
:set.. rule bad_DifferentTypes
    [r : %].
    5 [r] () = ()
;;

-- Bad: doesn't typecheck
:set.. rule bad_BadType
    [r : %].
    r [r] () = ()
;;


-- Bad: left-hand side shouldn't have binders
:set.. rule bad_Binders
    (x : Unit).
    (\(x : Unit). x) x = x
;;

-- Bad: left-hand side shouldn't have foralls
:set.. rule bad_Forall
    (i : Int R0#).
    (/\(a : *). id [a]) [Int R0#] i = i
;;

-- ..Ok: right-hand side can have binders
:set.. rule ok_BindersRhs
    (x : Unit).
    x = (\(x : Unit). x) ()
;;

-- Bad: no such constraint 'Mutz'
:set.. rule bad_Constraint
    [r : %].
    Mutz r =>
    0 [r] () = 1 [r] ()
;;

-- Bad: constraint isn't a witness
:set.. rule bad_Constraint2
    [r : %].
    Int r =>
    0 [r] () = 1 [r] ()
;;

-- Bad: not all variables mentioned in left-hand side
:set.. rule bad_Unmentioned
    [r : %].
    () = ()
;;

