
import Base
import System.File
import Data.Maybe

name	= "test/20-Library/File/Main.data";
empty	= "test/20-Library/File/Empty.data";
nonexistant	= "test/20-Library/File/DoesNotExist.data";

main () = topHandle prog;

prog ()
 = do 	print	$ "length = " % show (file_length name) % "\n"

	case file_read name of
	 Nothing 	-> print "failed\n"
	 Just ss	-> print $ "data = " % ss % "\n"

	case file_read empty of
	 Nothing 	-> print "failed\n"
	 Just ss	-> print $ "data = " % ss % "\n"

	case file_read nonexistant of
	 Nothing 	-> print "ok\n"
	 Just ss	-> print "failed\n"
