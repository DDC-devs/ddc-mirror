
import Base
import System.File
import Data.Maybe

name		= "test/40-Library/File/Main.data";
empty		= "test/40-Library/File/Empty.data";
nonexistant	= "test/40-Library/File/DoesNotExist.data";

main () = topHandle prog;

prog ()
 = do	case file_length name of
	 Nothing	-> print "failed\n"
	 Just len	-> print $ "length = " % show len % "\n"

	case file_read name of
	 Nothing 	-> print "failed\n"
	 Just ss	-> print $ "data = " % ss % "\n"

	case file_read empty of
	 Nothing 	-> print "failed\n"
	 Just ss	-> print $ "data = " % ss % "\n"

	case file_read nonexistant of
	 Nothing 	-> print "ok\n"
	 Just ss	-> print "failed\n"
