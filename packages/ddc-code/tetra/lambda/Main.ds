
module Main
import Lambda.Simple.Core.Exp
import Lambda.Simple.Core.Eval
import Lambda.Simple.Deep.Exp
import Lambda.Simple.Source.Pretty
import System.IO.Console
import Data.Maybe
where

show_Unit: Show Unit
 = Show $ Î»xx -> "()"

xIdent: Exp Unit
 = abs "x" (var "x")

xTwice: Exp Unit
 = abs "f" (abs "x" (app (var "f") (app (var "f") (var "x"))))

main ()
 = do   writel $ ppr (app xTwice xIdent)
        writel $ maybe "crash" ppr $ eval_cbn (app xTwice xIdent)
