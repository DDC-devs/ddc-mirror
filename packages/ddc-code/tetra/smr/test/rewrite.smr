% shimmer
% lang-resolve 
% prim-nat prim-match prim-exp

clean xx
 = #p-match xx
        (#nat-add (#nat-add #p #p) #p) 
        (\a. \b. \c. clean (#nat-add a (#nat-add b c)))
 $ #p-match xx (#


lift n d xx
 = #p-split xx (#x-var #p #p) (lift-var n d)
   xx;

lift-var n d n1 ix
 = @if  (#bool-and (#nat-eq n n1) (#nat-leq d ix))
        (#x-var n1 (#nat-add ix (#nat 1)))
        (#x-var n1 ix);
